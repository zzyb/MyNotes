# 高级用法

## 打开vim的选项

### 前进到特定的位置

| 命令               | 行为                             |
| ------------------ | -------------------------------- |
| vim +n file        | 在第n行打开vim                   |
| vim + file         | 在最后一行打开vim                |
| vim +/pattern file | 在第一个出现pattern的地方打开vim |

说明：

​	对于  <u>vim +/pattern file</u>  有时候我们需要匹配的内容有空格，我们采用以下两种方式来解决：

1. 用单引号或双引号括起整个模式

   ```shell
   vim +/"hello java" file
   //打开file在第一个出现hello java的地方
   ```

2. 用反斜线将空格转义

   ```shell
   vim +/hello\ java file
   //打开file在第一个出现hello java的地方
   ```

### 只读模式

​	如果你想查看文件，但是又不想无意间改动文件（例如读入一个很长的文件，用于练习vim命令等）。此时可以使用只读模式打开文件，这时候所有vim移动命令仍然可以使用，但是不能改变文件内容。

<u>注意：这是shell的限制，不是vim的限制。</u>

| 命令        | 行为                   |
| ----------- | ---------------------- |
| vim -R file | 只读模式打开文件       |
| view file   | 只读模式打开文件，同上 |

当然，如果你修改过后想要保留修改可以使用write命令：

1. :w!
2. :wq!

这样可以覆盖掉只读模式，保留你的修改。

## 对一处做标记

​	在vim中，可以对某处做一个看不见的“书签”，然后在别处编辑，完成后再回到“书签”位置。

| 命令 | 行为                                                       |
| ---- | ---------------------------------------------------------- |
| mx   | 将当前位置标记为x（x可以是任意字符）                       |
| 'x   | （单引号）将光标移动到标记x的第一个字符                    |
| `x   | （反引号）将光标移动到以x标记的字符                        |
| ``   | （两个反引号）将光标移动到上一个标记或上下文确切位置       |
| ''   | （两个单引号）将光标移动到上一个标记或上下文所在行开头位置 |

注意：标记只会在当前vim回话中有用，并不会存储在文件中。

## 善用缓冲区

​	编辑时，最后一个删除（d或x）或拖曳（y）的内容会保存到缓冲区（内存中的一块）。你可以访问这些缓冲区并使用放置命令（p或P）将这些保存的文本放回文件。

### 恢复删除

我们可以通过命令恢复你的前9次删除，因为他们都保存在编号的缓冲区中。

最后一次删除保存在缓冲区1

倒数第二次删除保存在缓冲区2中

······

```shell
"2p
//双引号、缓冲区编号、放置命令
//这条命令将恢复倒数第二次删除（缓冲区2的内容）
//恢复到光标之后
```

小技巧：

​	如果不确定哪一个缓冲区包含了要恢复到文本，我们不必重复输入"np。

​	在一次恢复命令（p）之后利用重复命令（.）做恢复，缓冲区编号会自动增加。结合u撤销恢复，即可逐个查看不同编号的缓冲区：

```shell
"1p
//恢复缓冲区1
u
//撤销恢复
.
//恢复缓冲区2
u
//撤销恢复
.
//恢复缓冲区3
//不断u、.直到找到所需文本为止
```

### 将文本拖曳到命名缓冲区中

我们可以使用<u>y于d</u>搭配<u>26个专门给复制与移动文本使用的命名缓冲区（a</u>

<u>~z）</u>。使用命名缓冲区来存放被拖曳的文本，便可以在任何时间取回其中的内容。

| 命令  | 作用                                            |
| ----- | ----------------------------------------------- |
| "dyy  | 将当前行拖曳到缓冲区d中                         |
| "a7yy | 将后续7行拖曳到缓冲区a中                        |
| "dP   | 将缓冲区d的内容放置在光标<u>**前**</u>（大写P） |
| "ap   | 将缓冲区a的内容放置在光标后（小写p）            |

​	**如果使用<u>大写字母</u>指定缓冲区名称，则拖曳或删除文本会被附加到当前缓冲区中。**

```shell
"zd)
//删除从光标开始到句子结尾处内容，并保存到缓冲区中。
"Zy2w
//将接下来的两个单词，添加到缓冲区中。
//注意：如果忘记使用大写，则会覆盖前面的缓冲区内容！！！
```

